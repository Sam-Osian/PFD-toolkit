{% load static %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PFD Toolkit AI Workbench Â· Beta</title>
    <link rel="stylesheet" href="{% static 'workbench/vendor/overlayscrollbars.min.css' %}?v=20260211l">
    <link rel="stylesheet" href="https://cdn.hugeicons.com/font/hgi-stroke-rounded.css">
    <link rel="stylesheet" href="{% static 'workbench/workbench.css' %}?v=20260212r">
</head>
<body class="page-{{ current_page|default:'home' }}">
    <script>
        (function () {
            try {
                if (window.innerWidth > 980 && window.localStorage.getItem("workbench.sidebarCollapsed") === "1") {
                    document.body.classList.add("sidebar-collapsed");
                }
            } catch (error) {
                // Ignore storage access issues.
            }
        })();
    </script>
    <div class="app-shell">
        {% block sidebar %}{% endblock %}
        <main class="main" id="main-root">
            <div
                id="page-content"
                data-page="{{ current_page|default:'home' }}"
                data-workspace-token="{{ workspace_dataset_token|default:'' }}"
            >
                {% if messages %}
                    <div class="messages">
                        {% for message in messages %}
                            <div class="message {{ message.tags|default:'info' }}">
                                <span>{{ message }}</span>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
                {% block content %}{% endblock %}
            </div>
        </main>
    </div>
    <div class="global-loading-overlay" id="global-loading-overlay" role="status" aria-live="polite" aria-hidden="true">
        <section class="global-loading-card" aria-label="Please wait">
            <div class="global-loading-orb" aria-hidden="true">
                <span class="global-loading-ring global-loading-ring--outer"></span>
                <span class="global-loading-ring global-loading-ring--inner"></span>
                <span class="global-loading-core"></span>
            </div>
            <div class="global-loading-copy">
                <p id="global-loading-message">Running your request...</p>
            </div>
        </section>
    </div>
    <script src="{% static 'workbench/vendor/overlayscrollbars.browser.es6.min.js' %}?v=20260211l"></script>
    <script src="{% static 'workbench/vendor/echarts.min.js' %}" defer></script>
    {% if current_page != "for_coders" %}
        <script src="{% static 'workbench/workbench.js' %}?v=20260212k"></script>
    {% else %}
        <script>
            (function () {
                const toggleButton = document.getElementById("sidebar-toggle");
                if (!toggleButton || toggleButton.dataset.bound === "1") {
                    return;
                }
                toggleButton.dataset.bound = "1";

                const storageKey = "workbench.sidebarCollapsed";

                function setCollapsedState(collapsed) {
                    document.body.classList.toggle("sidebar-collapsed", collapsed);
                    toggleButton.setAttribute("aria-expanded", String(!collapsed));
                    try {
                        window.localStorage.setItem(storageKey, collapsed ? "1" : "0");
                    } catch (error) {
                        // Ignore storage issues.
                    }
                }

                let collapsed = false;
                try {
                    collapsed = window.localStorage.getItem(storageKey) === "1";
                } catch (error) {
                    collapsed = false;
                }

                if (window.innerWidth <= 980) {
                    collapsed = false;
                }
                setCollapsedState(collapsed);

                toggleButton.addEventListener("click", function () {
                    const isCollapsed = document.body.classList.contains("sidebar-collapsed");
                    setCollapsedState(!isCollapsed);
                });

                window.addEventListener("resize", function () {
                    if (window.innerWidth <= 980 && document.body.classList.contains("sidebar-collapsed")) {
                        setCollapsedState(false);
                    }
                });
            })();
        </script>
    {% endif %}
</body>
</html>
